---
title: "Проект_03.11"
author: "Ksenia_V"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)

library(knitr)  
library(tidyverse)
```
  
``` {r echo=TRUE}
p1 <- ggplot(insurance_data, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "lightblue", color = "black", alpha = 0.7) +
  labs(title = "Распределение значений возраста",
       x = "Возраст",
       y = "Частота") +
  theme_minimal()

ggsave("plot_age.png", plot = p1, width = 8, height = 6, dpi = 300)
print(p1)

p2 <- ggplot(insurance_data, aes(x = family)) +
  geom_histogram(binwidth = 1, fill = "lightgreen", color = "black", alpha = 0.7) +
  labs(title = "Распределение значений о количестве членов семьи",
       x = "Количество членов семьи",
       y = "Частота") +
  theme_minimal()

ggsave("plot_family.png", plot = p2, width = 8, height = 6, dpi = 300)
print(p2)

categorical_vars <- c("health", "limit", "gender", "insurance", "married", "selfemp", "region", "ethnicity", "education")

for (var in categorical_vars) {
  p <- ggplot(insurance_data, aes_string(x = var)) +
    geom_bar(fill = "steelblue", color = "black", alpha = 0.7) +
    labs(title = switch(var,
        health = "Распределение по состоянию здоровья",
        limit = "Распределение по наличию ограничений",
        gender = "Распределение по полу",
        insurance = "Распределение по наличию медицинской страховки",
        married = "Распределение по семейному положению",
        selfemp = "Распределение по самозанятости",
        region = "Распределение по регионам",
        ethnicity = "Распределение по этнической принадлежности",
        education = "Распределение по наличию образования",
        "Распределение по переменной"), 
         x = "Категория",
         y = "Частота") +
    scale_x_discrete(labels = function(x) {
      switch(var,
        health = c("Здоров(-а)", "Есть проблемы со здоровьем"),
        limit = c("Да", "Нет"),
        gender = c("Мужской", "Женский"),
        insurance = c("Есть", "Нет"),
        married = c("Замужем/Женат", "Не замужем/Не женат"),
        selfemp = c("Самозанятый", "Не самозанятый"),
        region = c("Среднезападный", "Северо-восточный", "Южный", "Западный"),
        ethnicity = c("Афроамериканская", "Европейская", "Другие"),
        education = c("Бакалавр", "ООР", "Среднее", "Магистр", "Нет образования", "Другое", "PhD"),
        x)
    }) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 0, hjust = 0.5))

  print(p)  
    filename <- paste0("plot_", var, ".png")
  ggsave(filename, plot = p, width = 8, height = 6, dpi = 300)
}
```

#Распределение по возрасту имеет пик в диапазоне 35-40 лет.

#При оценке распределения по количеству членов семьи мы видим, что наибольшую частоту имеет значение "2", что возможно в случае, если это, например, два супруга или родитель и его ребенок. В целом мы видим, что большинство семей имеет от 2 до 4 членов семьи. 

#Распределение по состоянию здоровья демонстрирует, что абсолютное большинство респондентов оценивало свое состояние здоровья как неудовлетворительное. Это согласуется с данными, полученными при оценке распределения по наличию ограничений по здоровью по результатам объективного обследования - у большинства респондентов имеются такие ограничения по данным медицинского обследования.

#При оценке распределения по полу мы видим незначительное преобладаение респондентов женского пола над респондентами мужского.

#Большинство респондентов не имело медицинской страховки.

#Среди респондентов чаще встречались люди, не состоящие в браке.

#Абсолютное большинство респондентов были самозанятыми. Мы можем предположить, что авторы исследования целенаправленно изучали наличие медицинской страховки у самозанятых лиц.

#В распределении по регионам мы видим, что респондентов из южного региона было больше, чем из серднезападного, западного и северо-восточного.

#Абсолютное большинство респондентов были европейцами. 

#Распределение по наличию образования демонстрирует, что значительная часть респондентов не получала высшее образование. Это может указывать на взаимосвязь между наличием высшего образования и доступом к медицинской страховке.
